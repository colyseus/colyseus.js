!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Colyseus=t()}}(function(){return function t(e,r,n){function o(a,s){if(!r[a]){if(!e[a]){var f="function"==typeof require&&require;if(!s&&f)return f(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[a]={exports:{}};e[a][0].call(c.exports,function(t){var r=e[a][1][t];return o(r?r:t)},c,c.exports,t,e,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,r){var n=t("./lib/backoff"),o=t("./lib/strategy/exponential"),i=t("./lib/strategy/fibonacci"),a=t("./lib/function_call.js");e.exports.Backoff=n,e.exports.FunctionCall=a,e.exports.FibonacciStrategy=i,e.exports.ExponentialStrategy=o,e.exports.fibonacci=function(t){return new n(new i(t))},e.exports.exponential=function(t){return new n(new o(t))},e.exports.call=function(t,e,r){var n=Array.prototype.slice.call(arguments);return t=n[0],e=n.slice(1,n.length-1),r=n[n.length-1],new a(t,e,r)}},{"./lib/backoff":2,"./lib/function_call.js":3,"./lib/strategy/exponential":4,"./lib/strategy/fibonacci":5}],2:[function(t,e,r){function n(t){o.EventEmitter.call(this),this.backoffStrategy_=t,this.maxNumberOfRetry_=-1,this.backoffNumber_=0,this.backoffDelay_=0,this.timeoutID_=-1,this.handlers={backoff:this.onBackoff_.bind(this)}}var o=t("events"),i=t("precond"),a=t("util");a.inherits(n,o.EventEmitter),n.prototype.failAfter=function(t){i.checkArgument(t>0,"Expected a maximum number of retry greater than 0 but got %s.",t),this.maxNumberOfRetry_=t},n.prototype.backoff=function(t){i.checkState(-1===this.timeoutID_,"Backoff in progress."),this.backoffNumber_===this.maxNumberOfRetry_?(this.emit("fail",t),this.reset()):(this.backoffDelay_=this.backoffStrategy_.next(),this.timeoutID_=setTimeout(this.handlers.backoff,this.backoffDelay_),this.emit("backoff",this.backoffNumber_,this.backoffDelay_,t))},n.prototype.onBackoff_=function(){this.timeoutID_=-1,this.emit("ready",this.backoffNumber_,this.backoffDelay_),this.backoffNumber_++},n.prototype.reset=function(){this.backoffNumber_=0,this.backoffStrategy_.reset(),clearTimeout(this.timeoutID_),this.timeoutID_=-1},e.exports=n},{events:11,precond:38,util:43}],3:[function(t,e,r){function n(t,e,r){o.EventEmitter.call(this),i.checkIsFunction(t,"Expected fn to be a function."),i.checkIsArray(e,"Expected args to be an array."),i.checkIsFunction(r,"Expected callback to be a function."),this.function_=t,this.arguments_=e,this.callback_=r,this.lastResult_=[],this.numRetries_=0,this.backoff_=null,this.strategy_=null,this.failAfter_=-1,this.retryPredicate_=n.DEFAULT_RETRY_PREDICATE_,this.state_=n.State_.PENDING}var o=t("events"),i=t("precond"),a=t("util"),s=t("./backoff"),f=t("./strategy/fibonacci");a.inherits(n,o.EventEmitter),n.State_={PENDING:0,RUNNING:1,COMPLETED:2,ABORTED:3},n.DEFAULT_RETRY_PREDICATE_=function(t){return!0},n.prototype.isPending=function(){return this.state_==n.State_.PENDING},n.prototype.isRunning=function(){return this.state_==n.State_.RUNNING},n.prototype.isCompleted=function(){return this.state_==n.State_.COMPLETED},n.prototype.isAborted=function(){return this.state_==n.State_.ABORTED},n.prototype.setStrategy=function(t){return i.checkState(this.isPending(),"FunctionCall in progress."),this.strategy_=t,this},n.prototype.retryIf=function(t){return i.checkState(this.isPending(),"FunctionCall in progress."),this.retryPredicate_=t,this},n.prototype.getLastResult=function(){return this.lastResult_.concat()},n.prototype.getNumRetries=function(){return this.numRetries_},n.prototype.failAfter=function(t){return i.checkState(this.isPending(),"FunctionCall in progress."),this.failAfter_=t,this},n.prototype.abort=function(){this.isCompleted()||this.isAborted()||(this.isRunning()&&this.backoff_.reset(),this.state_=n.State_.ABORTED,this.lastResult_=[new Error("Backoff aborted.")],this.emit("abort"),this.doCallback_())},n.prototype.start=function(t){i.checkState(!this.isAborted(),"FunctionCall is aborted."),i.checkState(this.isPending(),"FunctionCall already started.");var e=this.strategy_||new f;this.backoff_=t?t(e):new s(e),this.backoff_.on("ready",this.doCall_.bind(this,!0)),this.backoff_.on("fail",this.doCallback_.bind(this)),this.backoff_.on("backoff",this.handleBackoff_.bind(this)),this.failAfter_>0&&this.backoff_.failAfter(this.failAfter_),this.state_=n.State_.RUNNING,this.doCall_(!1)},n.prototype.doCall_=function(t){t&&this.numRetries_++;var e=["call"].concat(this.arguments_);o.EventEmitter.prototype.emit.apply(this,e);var r=this.handleFunctionCallback_.bind(this);this.function_.apply(null,this.arguments_.concat(r))},n.prototype.doCallback_=function(){this.callback_.apply(null,this.lastResult_)},n.prototype.handleFunctionCallback_=function(){if(!this.isAborted()){var t=Array.prototype.slice.call(arguments);this.lastResult_=t,o.EventEmitter.prototype.emit.apply(this,["callback"].concat(t));var e=t[0];e&&this.retryPredicate_(e)?this.backoff_.backoff(e):(this.state_=n.State_.COMPLETED,this.doCallback_())}},n.prototype.handleBackoff_=function(t,e,r){this.emit("backoff",t,e,r)},e.exports=n},{"./backoff":2,"./strategy/fibonacci":5,events:11,precond:38,util:43}],4:[function(t,e,r){function n(t){a.call(this,t),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay(),this.factor_=n.DEFAULT_FACTOR,t&&void 0!==t.factor&&(i.checkArgument(t.factor>1,"Exponential factor should be greater than 1 but got %s.",t.factor),this.factor_=t.factor)}var o=t("util"),i=t("precond"),a=t("./strategy");o.inherits(n,a),n.DEFAULT_FACTOR=2,n.prototype.next_=function(){return this.backoffDelay_=Math.min(this.nextBackoffDelay_,this.getMaxDelay()),this.nextBackoffDelay_=this.backoffDelay_*this.factor_,this.backoffDelay_},n.prototype.reset_=function(){this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()},e.exports=n},{"./strategy":6,precond:38,util:43}],5:[function(t,e,r){function n(t){i.call(this,t),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()}var o=t("util"),i=t("./strategy");o.inherits(n,i),n.prototype.next_=function(){var t=Math.min(this.nextBackoffDelay_,this.getMaxDelay());return this.nextBackoffDelay_+=this.backoffDelay_,this.backoffDelay_=t,t},n.prototype.reset_=function(){this.nextBackoffDelay_=this.getInitialDelay(),this.backoffDelay_=0},e.exports=n},{"./strategy":6,util:43}],6:[function(t,e,r){function n(t){return void 0!==t&&null!==t}function o(t){if(t=t||{},n(t.initialDelay)&&t.initialDelay<1)throw new Error("The initial timeout must be greater than 0.");if(n(t.maxDelay)&&t.maxDelay<1)throw new Error("The maximal timeout must be greater than 0.");if(this.initialDelay_=t.initialDelay||100,this.maxDelay_=t.maxDelay||1e4,this.maxDelay_<=this.initialDelay_)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");if(n(t.randomisationFactor)&&(t.randomisationFactor<0||t.randomisationFactor>1))throw new Error("The randomisation factor must be between 0 and 1.");this.randomisationFactor_=t.randomisationFactor||0}t("events"),t("util");o.prototype.getMaxDelay=function(){return this.maxDelay_},o.prototype.getInitialDelay=function(){return this.initialDelay_},o.prototype.next=function(){var t=this.next_(),e=1+Math.random()*this.randomisationFactor_,r=Math.round(t*e);return r},o.prototype.next_=function(){throw new Error("BackoffStrategy.next_() unimplemented.")},o.prototype.reset=function(){this.reset_()},o.prototype.reset_=function(){throw new Error("BackoffStrategy.reset_() unimplemented.")},e.exports=o},{events:11,util:43}],7:[function(t,e,r){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===a||e===h?62:e===s||e===l?63:f>e?-1:f+10>e?e-f+26+26:c+26>e?e-c:u+26>e?e-u+26:void 0}function r(t){function r(t){u[h++]=t}var n,o,a,s,f,u;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=t.length;f="="===t.charAt(c-2)?2:"="===t.charAt(c-1)?1:0,u=new i(3*t.length/4-f),a=f>0?t.length-4:t.length;var h=0;for(n=0,o=0;a>n;n+=4,o+=3)s=e(t.charAt(n))<<18|e(t.charAt(n+1))<<12|e(t.charAt(n+2))<<6|e(t.charAt(n+3)),r((16711680&s)>>16),r((65280&s)>>8),r(255&s);return 2===f?(s=e(t.charAt(n))<<2|e(t.charAt(n+1))>>4,r(255&s)):1===f&&(s=e(t.charAt(n))<<10|e(t.charAt(n+1))<<4|e(t.charAt(n+2))>>2,r(s>>8&255),r(255&s)),u}function o(t){function e(t){return n.charAt(t)}function r(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var o,i,a,s=t.length%3,f="";for(o=0,a=t.length-s;a>o;o+=3)i=(t[o]<<16)+(t[o+1]<<8)+t[o+2],f+=r(i);switch(s){case 1:i=t[t.length-1],f+=e(i>>2),f+=e(i<<4&63),f+="==";break;case 2:i=(t[t.length-2]<<8)+t[t.length-1],f+=e(i>>10),f+=e(i>>4&63),f+=e(i<<2&63),f+="="}return f}var i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="+".charCodeAt(0),s="/".charCodeAt(0),f="0".charCodeAt(0),u="a".charCodeAt(0),c="A".charCodeAt(0),h="-".charCodeAt(0),l="_".charCodeAt(0);t.toByteArray=r,t.fromByteArray=o}("undefined"==typeof r?this.base64js={}:r)},{}],8:[function(t,e,r){(function(e){"use strict";function n(){function t(){}try{var e=new Uint8Array(1);return e.foo=function(){return 42},e.constructor=t,42===e.foo()&&e.constructor===t&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(r){return!1}}function o(){return i.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(t){return this instanceof i?(i.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=void 0),"number"==typeof t?a(this,t):"string"==typeof t?s(this,t,arguments.length>1?arguments[1]:"utf8"):f(this,t)):arguments.length>1?new i(t,arguments[1]):new i(t)}function a(t,e){if(t=y(t,0>e?0:0|v(e)),!i.TYPED_ARRAY_SUPPORT)for(var r=0;e>r;r++)t[r]=0;return t}function s(t,e,r){"string"==typeof r&&""!==r||(r="utf8");var n=0|b(e,r);return t=y(t,n),t.write(e,r),t}function f(t,e){if(i.isBuffer(e))return u(t,e);if($(e))return c(t,e);if(null==e)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(e.buffer instanceof ArrayBuffer)return h(t,e);if(e instanceof ArrayBuffer)return l(t,e)}return e.length?p(t,e):d(t,e)}function u(t,e){var r=0|v(e.length);return t=y(t,r),e.copy(t,0,0,r),t}function c(t,e){var r=0|v(e.length);t=y(t,r);for(var n=0;r>n;n+=1)t[n]=255&e[n];return t}function h(t,e){var r=0|v(e.length);t=y(t,r);for(var n=0;r>n;n+=1)t[n]=255&e[n];return t}function l(t,e){return i.TYPED_ARRAY_SUPPORT?(e.byteLength,t=i._augment(new Uint8Array(e))):t=h(t,new Uint8Array(e)),t}function p(t,e){var r=0|v(e.length);t=y(t,r);for(var n=0;r>n;n+=1)t[n]=255&e[n];return t}function d(t,e){var r,n=0;"Buffer"===e.type&&$(e.data)&&(r=e.data,n=0|v(r.length)),t=y(t,n);for(var o=0;n>o;o+=1)t[o]=255&r[o];return t}function y(t,e){i.TYPED_ARRAY_SUPPORT?(t=i._augment(new Uint8Array(e)),t.__proto__=i.prototype):(t.length=e,t._isBuffer=!0);var r=0!==e&&e<=i.poolSize>>>1;return r&&(t.parent=X),t}function v(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function g(t,e){if(!(this instanceof g))return new g(t,e);var r=new i(t,e);return delete r.parent,r}function b(t,e){"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"binary":case"raw":case"raws":return r;case"utf8":case"utf-8":return J(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return q(t).length;default:if(n)return J(t).length;e=(""+e).toLowerCase(),n=!0}}function E(t,e,r){var n=!1;if(e=0|e,r=void 0===r||r===1/0?this.length:0|r,t||(t="utf8"),0>e&&(e=0),r>this.length&&(r=this.length),e>=r)return"";for(;;)switch(t){case"hex":return U(this,e,r);case"utf8":case"utf-8":return O(this,e,r);case"ascii":return P(this,e,r);case"binary":return R(this,e,r);case"base64":return I(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function w(t,e,r,n){r=Number(r)||0;var o=t.length-r;n?(n=Number(n),n>o&&(n=o)):n=o;var i=e.length;if(i%2!==0)throw new Error("Invalid hex string");n>i/2&&(n=i/2);for(var a=0;n>a;a++){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))throw new Error("Invalid hex string");t[r+a]=s}return a}function m(t,e,r,n){return H(J(e,t.length-r),t,r,n)}function _(t,e,r,n){return H(V(e),t,r,n)}function k(t,e,r,n){return _(t,e,r,n)}function A(t,e,r,n){return H(q(e),t,r,n)}function x(t,e,r,n){return H(G(e,t.length-r),t,r,n)}function I(t,e,r){return 0===e&&r===t.length?W.fromByteArray(t):W.fromByteArray(t.slice(e,r))}function O(t,e,r){r=Math.min(t.length,r);for(var n=[],o=e;r>o;){var i=t[o],a=null,s=i>239?4:i>223?3:i>191?2:1;if(r>=o+s){var f,u,c,h;switch(s){case 1:128>i&&(a=i);break;case 2:f=t[o+1],128===(192&f)&&(h=(31&i)<<6|63&f,h>127&&(a=h));break;case 3:f=t[o+1],u=t[o+2],128===(192&f)&&128===(192&u)&&(h=(15&i)<<12|(63&f)<<6|63&u,h>2047&&(55296>h||h>57343)&&(a=h));break;case 4:f=t[o+1],u=t[o+2],c=t[o+3],128===(192&f)&&128===(192&u)&&128===(192&c)&&(h=(15&i)<<18|(63&f)<<12|(63&u)<<6|63&c,h>65535&&1114112>h&&(a=h))}}null===a?(a=65533,s=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),o+=s}return B(n)}function B(t){var e=t.length;if(Z>=e)return String.fromCharCode.apply(String,t);for(var r="",n=0;e>n;)r+=String.fromCharCode.apply(String,t.slice(n,n+=Z));return r}function P(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;r>o;o++)n+=String.fromCharCode(127&t[o]);return n}function R(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;r>o;o++)n+=String.fromCharCode(t[o]);return n}function U(t,e,r){var n=t.length;(!e||0>e)&&(e=0),(!r||0>r||r>n)&&(r=n);for(var o="",i=e;r>i;i++)o+=z(t[i]);return o}function T(t,e,r){for(var n=t.slice(e,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function S(t,e,r){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function D(t,e,r,n,o,a){if(!i.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>o||a>e)throw new RangeError("value is out of bounds");if(r+n>t.length)throw new RangeError("index out of range")}function C(t,e,r,n){0>e&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-r,2);i>o;o++)t[r+o]=(e&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function L(t,e,r,n){0>e&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-r,4);i>o;o++)t[r+o]=e>>>8*(n?o:3-o)&255}function N(t,e,r,n,o,i){if(e>o||i>e)throw new RangeError("value is out of bounds");if(r+n>t.length)throw new RangeError("index out of range");if(0>r)throw new RangeError("index out of range")}function j(t,e,r,n,o){return o||N(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),Q.write(t,e,r,n,23,4),r+4}function M(t,e,r,n,o){return o||N(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),Q.write(t,e,r,n,52,8),r+8}function F(t){if(t=Y(t).replace(tt,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function Y(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function z(t){return 16>t?"0"+t.toString(16):t.toString(16)}function J(t,e){e=e||1/0;for(var r,n=t.length,o=null,i=[],a=0;n>a;a++){if(r=t.charCodeAt(a),r>55295&&57344>r){if(!o){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(a+1===n){(e-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(56320>r){(e-=3)>-1&&i.push(239,191,189),o=r;continue}r=(o-55296<<10|r-56320)+65536}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,128>r){if((e-=1)<0)break;i.push(r)}else if(2048>r){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(65536>r){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(1114112>r))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function V(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e}function G(t,e){for(var r,n,o,i=[],a=0;a<t.length&&!((e-=2)<0);a++)r=t.charCodeAt(a),n=r>>8,o=r%256,i.push(o),i.push(n);return i}function q(t){return W.toByteArray(F(t))}function H(t,e,r,n){for(var o=0;n>o&&!(o+r>=e.length||o>=t.length);o++)e[o+r]=t[o];return o}var W=t("base64-js"),Q=t("ieee754"),$=t("isarray");r.Buffer=i,r.SlowBuffer=g,r.INSPECT_MAX_BYTES=50,i.poolSize=8192;var X={};i.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:n(),i.TYPED_ARRAY_SUPPORT?(i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array):(i.prototype.length=void 0,i.prototype.parent=void 0),i.isBuffer=function(t){return!(null==t||!t._isBuffer)},i.compare=function(t,e){if(!i.isBuffer(t)||!i.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,o=0,a=Math.min(r,n);a>o&&t[o]===e[o];)++o;return o!==a&&(r=t[o],n=e[o]),n>r?-1:r>n?1:0},i.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(t,e){if(!$(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new i(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;r++)e+=t[r].length;var n=new i(e),o=0;for(r=0;r<t.length;r++){var a=t[r];a.copy(n,o),o+=a.length}return n},i.byteLength=b,i.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?O(this,0,t):E.apply(this,arguments)},i.prototype.equals=function(t){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:0===i.compare(this,t)},i.prototype.inspect=function(){var t="",e=r.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},i.prototype.compare=function(t){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:i.compare(this,t)},i.prototype.indexOf=function(t,e){function r(t,e,r){for(var n=-1,o=0;r+o<t.length;o++)if(t[r+o]===e[-1===n?0:o-n]){if(-1===n&&(n=o),o-n+1===e.length)return r+n}else n=-1;return-1}if(e>2147483647?e=2147483647:-2147483648>e&&(e=-2147483648),e>>=0,0===this.length)return-1;if(e>=this.length)return-1;if(0>e&&(e=Math.max(this.length+e,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,e);if(i.isBuffer(t))return r(this,t,e);if("number"==typeof t)return i.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,e):r(this,[t],e);throw new TypeError("val must be string, number or Buffer")},i.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},i.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},i.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else if(isFinite(e))e=0|e,isFinite(r)?(r=0|r,void 0===n&&(n="utf8")):(n=r,r=void 0);else{var o=n;n=e,e=0|r,r=o}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(0>r||0>e)||e>this.length)throw new RangeError("attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return w(this,t,e,r);case"utf8":case"utf-8":return m(this,t,e,r);case"ascii":return _(this,t,e,r);case"binary":return k(this,t,e,r);case"base64":return A(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,e,r);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;i.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,0>t?(t+=r,0>t&&(t=0)):t>r&&(t=r),0>e?(e+=r,0>e&&(e=0)):e>r&&(e=r),t>e&&(e=t);var n;if(i.TYPED_ARRAY_SUPPORT)n=i._augment(this.subarray(t,e));else{var o=e-t;n=new i(o,void 0);for(var a=0;o>a;a++)n[a]=this[a+t]}return n.length&&(n.parent=this.parent||this),n},i.prototype.readUIntLE=function(t,e,r){t=0|t,e=0|e,r||S(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n},i.prototype.readUIntBE=function(t,e,r){t=0|t,e=0|e,r||S(t,e,this.length);for(var n=this[t+--e],o=1;e>0&&(o*=256);)n+=this[t+--e]*o;return n},i.prototype.readUInt8=function(t,e){return e||S(t,1,this.length),this[t]},i.prototype.readUInt16LE=function(t,e){return e||S(t,2,this.length),this[t]|this[t+1]<<8},i.prototype.readUInt16BE=function(t,e){return e||S(t,2,this.length),this[t]<<8|this[t+1]},i.prototype.readUInt32LE=function(t,e){return e||S(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},i.prototype.readUInt32BE=function(t,e){return e||S(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},i.prototype.readIntLE=function(t,e,r){t=0|t,e=0|e,r||S(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*e)),n},i.prototype.readIntBE=function(t,e,r){t=0|t,e=0|e,r||S(t,e,this.length);for(var n=e,o=1,i=this[t+--n];n>0&&(o*=256);)i+=this[t+--n]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},i.prototype.readInt8=function(t,e){return e||S(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},i.prototype.readInt16LE=function(t,e){e||S(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt16BE=function(t,e){e||S(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt32LE=function(t,e){return e||S(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},i.prototype.readInt32BE=function(t,e){return e||S(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},i.prototype.readFloatLE=function(t,e){return e||S(t,4,this.length),Q.read(this,t,!0,23,4)},i.prototype.readFloatBE=function(t,e){return e||S(t,4,this.length),Q.read(this,t,!1,23,4)},i.prototype.readDoubleLE=function(t,e){return e||S(t,8,this.length),Q.read(this,t,!0,52,8)},i.prototype.readDoubleBE=function(t,e){return e||S(t,8,this.length),Q.read(this,t,!1,52,8)},i.prototype.writeUIntLE=function(t,e,r,n){t=+t,e=0|e,r=0|r,n||D(this,t,e,r,Math.pow(2,8*r),0);var o=1,i=0;for(this[e]=255&t;++i<r&&(o*=256);)this[e+i]=t/o&255;return e+r},i.prototype.writeUIntBE=function(t,e,r,n){t=+t,e=0|e,r=0|r,n||D(this,t,e,r,Math.pow(2,8*r),0);var o=r-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+r},i.prototype.writeUInt8=function(t,e,r){return t=+t,e=0|e,r||D(this,t,e,1,255,0),i.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},i.prototype.writeUInt16LE=function(t,e,r){return t=+t,e=0|e,r||D(this,t,e,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):C(this,t,e,!0),e+2},i.prototype.writeUInt16BE=function(t,e,r){return t=+t,e=0|e,r||D(this,t,e,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):C(this,t,e,!1),e+2},i.prototype.writeUInt32LE=function(t,e,r){return t=+t,e=0|e,r||D(this,t,e,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):L(this,t,e,!0),e+4},i.prototype.writeUInt32BE=function(t,e,r){return t=+t,e=0|e,r||D(this,t,e,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):L(this,t,e,!1),e+4},i.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e=0|e,!n){var o=Math.pow(2,8*r-1);D(this,t,e,r,o-1,-o)}var i=0,a=1,s=0>t?1:0;for(this[e]=255&t;++i<r&&(a*=256);)this[e+i]=(t/a>>0)-s&255;return e+r},i.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e=0|e,!n){var o=Math.pow(2,8*r-1);D(this,t,e,r,o-1,-o)}var i=r-1,a=1,s=0>t?1:0;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=(t/a>>0)-s&255;return e+r},i.prototype.writeInt8=function(t,e,r){return t=+t,e=0|e,r||D(this,t,e,1,127,-128),i.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[e]=255&t,e+1},i.prototype.writeInt16LE=function(t,e,r){return t=+t,e=0|e,r||D(this,t,e,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):C(this,t,e,!0),e+2},i.prototype.writeInt16BE=function(t,e,r){return t=+t,e=0|e,r||D(this,t,e,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):C(this,t,e,!1),e+2},i.prototype.writeInt32LE=function(t,e,r){return t=+t,e=0|e,r||D(this,t,e,4,2147483647,-2147483648),i.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):L(this,t,e,!0),e+4},i.prototype.writeInt32BE=function(t,e,r){return t=+t,e=0|e,r||D(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):L(this,t,e,!1),e+4},i.prototype.writeFloatLE=function(t,e,r){return j(this,t,e,!0,r)},i.prototype.writeFloatBE=function(t,e,r){return j(this,t,e,!1,r)},i.prototype.writeDoubleLE=function(t,e,r){return M(this,t,e,!0,r)},i.prototype.writeDoubleBE=function(t,e,r){return M(this,t,e,!1,r)},i.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&r>n&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(0>e)throw new RangeError("targetStart out of bounds");if(0>r||r>=this.length)throw new RangeError("sourceStart out of bounds");if(0>n)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var o,a=n-r;if(this===t&&e>r&&n>e)for(o=a-1;o>=0;o--)t[o+e]=this[o+r];else if(1e3>a||!i.TYPED_ARRAY_SUPPORT)for(o=0;a>o;o++)t[o+e]=this[o+r];else t._set(this.subarray(r,r+a),e);return a},i.prototype.fill=function(t,e,r){if(t||(t=0),e||(e=0),r||(r=this.length),e>r)throw new RangeError("end < start");if(r!==e&&0!==this.length){if(0>e||e>=this.length)throw new RangeError("start out of bounds");if(0>r||r>this.length)throw new RangeError("end out of bounds");var n;if("number"==typeof t)for(n=e;r>n;n++)this[n]=t;else{var o=J(t.toString()),i=o.length;for(n=e;r>n;n++)this[n]=o[n%i]}return this}},i.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(i.TYPED_ARRAY_SUPPORT)return new i(this).buffer;for(var t=new Uint8Array(this.length),e=0,r=t.length;r>e;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var K=i.prototype;i._augment=function(t){return t.constructor=i,t._isBuffer=!0,t._set=t.set,t.get=K.get,t.set=K.set,t.write=K.write,t.toString=K.toString,t.toLocaleString=K.toString,t.toJSON=K.toJSON,t.equals=K.equals,t.compare=K.compare,t.indexOf=K.indexOf,t.copy=K.copy,t.slice=K.slice,t.readUIntLE=K.readUIntLE,t.readUIntBE=K.readUIntBE,t.readUInt8=K.readUInt8,t.readUInt16LE=K.readUInt16LE,t.readUInt16BE=K.readUInt16BE,t.readUInt32LE=K.readUInt32LE,t.readUInt32BE=K.readUInt32BE,t.readIntLE=K.readIntLE,t.readIntBE=K.readIntBE,t.readInt8=K.readInt8,t.readInt16LE=K.readInt16LE,t.readInt16BE=K.readInt16BE,t.readInt32LE=K.readInt32LE,t.readInt32BE=K.readInt32BE,t.readFloatLE=K.readFloatLE,t.readFloatBE=K.readFloatBE,t.readDoubleLE=K.readDoubleLE,t.readDoubleBE=K.readDoubleBE,t.writeUInt8=K.writeUInt8,t.writeUIntLE=K.writeUIntLE,t.writeUIntBE=K.writeUIntBE,t.writeUInt16LE=K.writeUInt16LE,t.writeUInt16BE=K.writeUInt16BE,t.writeUInt32LE=K.writeUInt32LE,t.writeUInt32BE=K.writeUInt32BE,t.writeIntLE=K.writeIntLE,t.writeIntBE=K.writeIntBE,t.writeInt8=K.writeInt8,t.writeInt16LE=K.writeInt16LE,t.writeInt16BE=K.writeInt16BE,t.writeInt32LE=K.writeInt32LE,t.writeInt32BE=K.writeInt32BE,t.writeFloatLE=K.writeFloatLE,t.writeFloatBE=K.writeFloatBE,t.writeDoubleLE=K.writeDoubleLE,t.writeDoubleBE=K.writeDoubleBE,t.fill=K.fill,t.inspect=K.inspect,t.toArrayBuffer=K.toArrayBuffer,t};var tt=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":7,ieee754:14,isarray:17}],9:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];n(this,t),this.running=!1,this.deltaTime=0,this.currentTime=0,this.elapsedTime=0,this.now="undefined"!=typeof window&&window.performance&&window.performance.now.bind(window.performance)||Date.now,this.start(),e&&setInterval(this.tick.bind(this),1e3/60)}return o(t,[{key:"start",value:function(){this.deltaTime=0,this.currentTime=this.now(),this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.running=!1}},{key:"tick",value:function(){var t=arguments.length<=0||void 0===arguments[0]?this.now():arguments[0];this.deltaTime=t-this.currentTime,this.currentTime=t,this.elapsedTime+=this.deltaTime}}]),t}();e.exports=i},{}],10:[function(t,e,r){function n(){return this instanceof n?void 0:new n}!function(t){function r(t){for(var e in u)t[e]=u[e];return t}function n(t,e){return s(this,t).push(e),this}function o(t,e){function r(){i.call(n,t,r),e.apply(this,arguments)}var n=this;return r.originalListener=e,s(n,t).push(r),n}function i(t,e){function r(t){return t!==e&&t.originalListener!==e}var n,o=this;if(arguments.length){if(e){if(n=s(o,t,!0)){if(n=n.filter(r),!n.length)return i.call(o,t);o[f][t]=n}}else if(n=o[f],n&&(delete n[t],!Object.keys(n).length))return i.call(o)}else delete o[f];return o}function a(t,e){function r(t){t.call(i)}function n(t){t.call(i,e)}function o(t){t.apply(i,u)}var i=this,a=s(i,t,!0);if(!a)return!1;var f=arguments.length;if(1===f)a.forEach(r);else if(2===f)a.forEach(n);else{var u=Array.prototype.slice.call(arguments,1);a.forEach(o)}return!!a.length}function s(t,e,r){if(!r||t[f]){var n=t[f]||(t[f]={});return n[e]||(n[e]=[])}}"undefined"!=typeof e&&(e.exports=t);var f="listeners",u={on:n,once:o,off:i,emit:a};r(t.prototype),t.mixin=r}(n)},{}],11:[function(t,e,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(t){return"function"==typeof t}function i(t){return"number"==typeof t}function a(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!i(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,r,n,i,f,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[t],s(r))return!1;if(o(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),r.apply(this,i)}else if(a(r))for(i=Array.prototype.slice.call(arguments,1),u=r.slice(),n=u.length,f=0;n>f;f++)u[f].apply(this,i);return!0},n.prototype.addListener=function(t,e){var r;if(!o(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,o(e.listener)?e.listener:e),this._events[t]?a(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,a(this._events[t])&&!this._events[t].warned&&(r=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),
this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}if(!o(e))throw TypeError("listener must be a function");var n=!1;return r.listener=e,this.on(t,r),this},n.prototype.removeListener=function(t,e){var r,n,i,s;if(!o(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],i=r.length,n=-1,r===e||o(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(a(r)){for(s=i;s-- >0;)if(r[s]===e||r[s].listener&&r[s].listener===e){n=s;break}if(0>n)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],o(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?o(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(o(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},{}],12:[function(t,e,r){var n,o=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},i=Error;!function(t){function e(t,r){switch(typeof t){case"undefined":case"boolean":case"string":case"number":return t===r;case"object":if(null===t)return null===r;if(I(t)){if(!I(r)||t.length!==r.length)return!1;for(var n=0,o=t.length;o>n;n++)if(!e(t[n],r[n]))return!1;return!0}var i=E(r),a=i.length;if(E(t).length!==a)return!1;for(var n=0;a>n;n++)if(!e(t[n],r[n]))return!1;return!0;default:return!1}}function r(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function n(t){for(var e=0,r=k.length;r>e;e++)if(k[e].obj===t)return k[e]}function a(t,e){for(var r=0,n=t.observers.length;n>r;r++)if(t.observers[r].callback===e)return t.observers[r].observer}function s(t,e){for(var r=0,n=t.observers.length;n>r;r++)if(t.observers[r].observer===e)return void t.observers.splice(r,1)}function f(t,e){e.unobserve()}function u(t){return"object"==typeof t?JSON.parse(JSON.stringify(t)):t}function c(t,e){var r,o=[],f=n(t);if(f?r=a(f,e):(f=new A(t),k.push(f)),r)return r;if(r={},f.value=u(t),e){r.callback=e,r.next=null;var c=this.intervals||[100,1e3,1e4,6e4];if(void 0===c.push)throw new i("jsonpatch.intervals must be an array");var l=0,p=function(){h(r)},d=function(){clearTimeout(r.next),r.next=setTimeout(function(){p(),l=0,r.next=setTimeout(y,c[l++])},0)},y=function(){p(),l==c.length&&(l=c.length-1),r.next=setTimeout(y,c[l++])};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mousedown",d),window.addEventListener("mouseup",d),window.addEventListener("keydown",d)):(document.documentElement.attachEvent("onmousedown",d),document.documentElement.attachEvent("onmouseup",d),document.documentElement.attachEvent("onkeydown",d))),r.next=setTimeout(y,c[l++])}return r.patches=o,r.object=t,r.unobserve=function(){h(r),clearTimeout(r.next),s(f,r),"undefined"!=typeof window&&(window.removeEventListener?(window.removeEventListener("mousedown",d),window.removeEventListener("mouseup",d),window.removeEventListener("keydown",d)):(document.documentElement.detachEvent("onmousedown",d),document.documentElement.detachEvent("onmouseup",d),document.documentElement.detachEvent("onkeydown",d)))},f.observers.push(new x(e,r)),r}function h(t){for(var e,r=0,n=k.length;n>r;r++)if(k[r].obj===t.object){e=k[r];break}l(e.value,t.object,t.patches,""),t.patches.length&&d(e.value,t.patches);var o=t.patches;return o.length>0&&(t.patches=[],t.callback&&t.callback(o)),o}function l(t,e,n,o){for(var i=E(e),a=E(t),s=!1,f=!1,c=a.length-1;c>=0;c--){var h=a[c],p=t[h];if(e.hasOwnProperty(h)){var d=e[h];"object"==typeof p&&null!=p&&"object"==typeof d&&null!=d?l(p,d,n,o+"/"+r(h)):p!=d&&(s=!0,n.push({op:"replace",path:o+"/"+r(h),value:u(d)}))}else n.push({op:"remove",path:o+"/"+r(h)}),f=!0}if(f||i.length!=a.length)for(var c=0;c<i.length;c++){var h=i[c];t.hasOwnProperty(h)||n.push({op:"add",path:o+"/"+r(h),value:u(e[h])})}}function p(t){for(var e,r=0,n=t.length;n>r;){e=t.charCodeAt(r);{if(!(e>=48&&57>=e))return!1;r++}}return!0}function d(t,e,r){for(var n,o,i=!1,a=0,s=e.length;s>a;){n=e[a],a++;for(var f=n.path||"",u=f.split("/"),c=t,h=1,l=u.length,d=void 0;;){if(o=u[h],r&&void 0===d&&(void 0===c[o]?d=u.slice(0,h).join("/"):h==l-1&&(d=n.path),void 0!==d&&this.validator(n,a-1,t,d)),h++,void 0===o&&h>=l){i=_[n.op].call(n,c,o,t);break}if(I(c)){if("-"===o)o=c.length;else{if(r&&!p(o))throw new O("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a-1,n.path,n);o=parseInt(o,10)}if(h>=l){if(r&&"add"===n.op&&o>c.length)throw new O("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a-1,n.path,n);i=m[n.op].call(n,c,o,t);break}}else if(o&&-1!=o.indexOf("~")&&(o=o.replace(/~1/g,"/").replace(/~0/g,"~")),h>=l){i=w[n.op].call(n,c,o,t);break}c=c[o]}}return i}function y(t,e){var r=[];return l(t,e,r,""),r}function v(t){if(void 0===t)return!0;if("array"==typeof t||"object"==typeof t)for(var e in t)if(v(t[e]))return!0;return!1}function g(e,r,n,o){if("object"!=typeof e||null===e||I(e))throw new O("Operation is not an object","OPERATION_NOT_AN_OBJECT",r,e,n);if(!w[e.op])throw new O("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",r,e,n);if("string"!=typeof e.path)throw new O("Operation `path` property is not a string","OPERATION_PATH_INVALID",r,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new O("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",r,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new O("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",r,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&v(e.value))throw new O("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",r,e,n);if(n)if("add"==e.op){var i=e.path.split("/").length,a=o.split("/").length;if(i!==a+1&&i!==a)throw new O("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",r,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==o)throw new O("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",r,e,n)}else if("move"===e.op||"copy"===e.op){var s={op:"_get",path:e.from,value:void 0},f=t.validate([s],n);if(f&&"OPERATION_PATH_UNRESOLVABLE"===f.name)throw new O("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",r,e,n)}}function b(t,e){try{if(!I(t))throw new O("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)e=JSON.parse(JSON.stringify(e)),d.call(this,e,t,!0);else for(var r=0;r<t.length;r++)this.validator(t[r],r)}catch(n){if(n instanceof O)return n;throw n}}var E=function(t){if(I(t)){for(var e=new Array(t.length),r=0;r<e.length;r++)e[r]=""+r;return e}if(Object.keys)return Object.keys(t);var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e},w={add:function(t,e){return t[e]=this.value,!0},remove:function(t,e){return delete t[e],!0},replace:function(t,e){return t[e]=this.value,!0},move:function(t,e,r){var n={op:"_get",path:this.from};return d(r,[n]),d(r,[{op:"remove",path:this.from}]),d(r,[{op:"add",path:this.path,value:n.value}]),!0},copy:function(t,e,r){var n={op:"_get",path:this.from};return d(r,[n]),d(r,[{op:"add",path:this.path,value:n.value}]),!0},test:function(t,r){return e(t[r],this.value)},_get:function(t,e){this.value=t[e]}},m={add:function(t,e){return t.splice(e,0,this.value),!0},remove:function(t,e){return t.splice(e,1),!0},replace:function(t,e){return t[e]=this.value,!0},move:w.move,copy:w.copy,test:w.test,_get:w._get},_={add:function(t){_.remove.call(this,t);for(var e in this.value)this.value.hasOwnProperty(e)&&(t[e]=this.value[e]);return!0},remove:function(t){for(var e in t)t.hasOwnProperty(e)&&w.remove.call(this,t,e);return!0},replace:function(t){return d(t,[{op:"remove",path:this.path}]),d(t,[{op:"add",path:this.path,value:this.value}]),!0},move:w.move,copy:w.copy,test:function(t){return JSON.stringify(t)===JSON.stringify(this.value)},_get:function(t){this.value=t}},k=[],A=function(){function t(t){this.observers=[],this.obj=t}return t}(),x=function(){function t(t,e){this.callback=t,this.observer=e}return t}();t.unobserve=f,t.observe=c,t.generate=h;var I;I=Array.isArray?Array.isArray:function(t){return t.push&&"number"==typeof t.length},t.apply=d,t.compare=y;var O=function(t){function e(e,r,n,o,i){t.call(this,e),this.message=e,this.name=r,this.index=n,this.operation=o,this.tree=i}return o(e,t),e}(i);t.JsonPatchError=O,t.Error=O,t.validator=g,t.validate=b}(n||(n={})),"undefined"!=typeof r&&(r.apply=n.apply,r.observe=n.observe,r.unobserve=n.unobserve,r.generate=n.generate,r.compare=n.compare,r.validate=n.validate,r.validator=n.validator,r.JsonPatchError=n.JsonPatchError,r.Error=n.Error)},{}],13:[function(t,e,r){!function(t,r){"undefined"!=typeof e&&e.exports?e.exports=r():t.fossilDelta=r()}(this,function(){"use strict";function t(){this.a=0,this.b=0,this.i=0,this.z=new Array(a)}function e(t){this.a=t,this.pos=0}function r(){this.a=[]}function n(t){var e,r;for(e=1,r=64;t>=r;e++,r<<=6);return e}function o(t){for(var e=0,r=0,n=0,o=0,i=0,a=t.length;a>=16;)e=e+t[i+0]|0,r=r+t[i+1]|0,n=n+t[i+2]|0,o=o+t[i+3]|0,e=e+t[i+4]|0,r=r+t[i+5]|0,n=n+t[i+6]|0,o=o+t[i+7]|0,e=e+t[i+8]|0,r=r+t[i+9]|0,n=n+t[i+10]|0,o=o+t[i+11]|0,e=e+t[i+12]|0,r=r+t[i+13]|0,n=n+t[i+14]|0,o=o+t[i+15]|0,i+=16,a-=16;for(;a>=4;)e=e+t[i+0]|0,r=r+t[i+1]|0,n=n+t[i+2]|0,o=o+t[i+3]|0,i+=4,a-=4;switch(o=((o+(n<<8)|0)+(r<<16)|0)+(e<<24)|0,a){case 3:o=o+(t[i+2]<<8)|0;case 2:o=o+(t[i+1]<<16)|0;case 1:o=o+(t[i+0]<<24)|0}return o>>>0}var i={},a=16;t.prototype.init=function(t,e){var r,n,o=0,i=0;for(r=0;a>r;r++)n=t[e+r],o=o+n&65535,i=i+(a-r)*n&65535,this.z[r]=n;this.a=65535&o,this.b=65535&i,this.i=0},t.prototype.next=function(t){var e=this.z[this.i];this.z[this.i]=t,this.i=this.i+1&a-1,this.a=this.a-e+t&65535,this.b=this.b-a*e+this.a&65535},t.prototype.value=function(){return(65535&this.a|(65535&this.b)<<16)>>>0};var s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz~".split("").map(function(t){return t.charCodeAt(0)}),f=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,36,-1,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,-1,-1,-1,63,-1];return e.prototype.haveBytes=function(){return this.pos<this.a.length},e.prototype.getByte=function(){var t=this.a[this.pos];if(this.pos++,this.pos>this.a.length)throw new RangeError("out of bounds");return t},e.prototype.getChar=function(){return String.fromCharCode(this.getByte())},e.prototype.getInt=function(){for(var t,e=0;this.haveBytes()&&(t=f[127&this.getByte()])>=0;)e=(e<<6)+t;return this.pos--,e>>>0},r.prototype.toArray=function(){return this.a},r.prototype.putByte=function(t){this.a.push(255&t)},r.prototype.putChar=function(t){this.putByte(t.charCodeAt(0))},r.prototype.putInt=function(t){var e,r,n=[];if(0===t)return void this.putChar("0");for(e=0;t>0;e++,t>>>=6)n.push(s[63&t]);for(r=e-1;r>=0;r--)this.putByte(n[r])},r.prototype.putArray=function(t,e,r){for(var n=e;r>n;n++)this.a.push(t[n])},i.create=function(e,i){var s,f=new r,u=i.length,c=e.length,h=-1;if(f.putInt(u),f.putChar("\n"),a>=c)return f.putInt(u),f.putChar(":"),f.putArray(i,0,u),f.putInt(o(i)),f.putChar(";"),f.toArray();var l=Math.ceil(c/a),p=new Array(l),d=new Array(l);for(s=0;s<p.length;s++)p[s]=-1;for(s=0;s<d.length;s++)d[s]=-1;var y,v=new t;for(s=0;c-a>s;s+=a)v.init(e,s),y=v.value()%l,p[s/a]=d[y],d[y]=s/a;for(var g,b,E,w,m,_=0;u>_+a;)for(w=0,m=0,v.init(i,_),s=0,E=0;;){var k=250;for(y=v.value()%l,b=d[y];b>=0&&k-- >0;){var A,x,I,O,B,P,R,U;for(g=b*a,O=0,P=g,R=_+s;c>P&&u>R&&e[P]===i[R];O++,P++,R++);for(O--,B=1;g>B&&s>=B&&e[g-B]===i[_+s-B];B++);B--,x=g-B,A=O+B+1,I=s-B,U=n(s-B)+n(A)+n(x)+3,A>=U&&A>E&&(E=A,w=g-B,m=I),b=p[b]}if(E>0){m>0&&(f.putInt(m),f.putChar(":"),f.putArray(i,_,_+m),_+=m),_+=E,f.putInt(E),f.putChar("@"),f.putInt(w),f.putChar(","),w+E-1>h&&(h=w+E-1),E=0;break}if(_+s+a>=u){f.putInt(u-_),f.putChar(":"),f.putArray(i,_,_+u-_),_=u;break}v.next(i[_+s+a]),s++}return u>_&&(f.putInt(u-_),f.putChar(":"),f.putArray(i,_,_+u-_)),f.putInt(o(i)),f.putChar(";"),f.toArray()},i.outputSize=function(t){var r=new e(t),n=r.getInt();if("\n"!==r.getChar())throw new Error("size integer not terminated by '\\n'");return n},i.apply=function(t,n){var i,a=0,s=new e(n),f=t.length,u=n.length;if(i=s.getInt(),"\n"!==s.getChar())throw new Error("size integer not terminated by '\\n'");for(var c=new r;s.haveBytes();){var h,l;switch(h=s.getInt(),s.getChar()){case"@":if(l=s.getInt(),s.haveBytes()&&","!==s.getChar())throw new Error("copy command not terminated by ','");if(a+=h,a>i)throw new Error("copy exceeds output file size");if(l+h>f)throw new Error("copy extends past end of input");c.putArray(t,l,l+h);break;case":":if(a+=h,a>i)throw new Error("insert command gives an output larger than predicted");if(h>u)throw new Error("insert count exceeds size of delta");c.putArray(s.a,s.pos,s.pos+h),s.pos+=h;break;case";":var p=c.toArray();if(h!==o(p))throw new Error("bad checksum");if(a!==i)throw new Error("generated size does not match predicted size");return p;default:throw new Error("unknown delta operator")}}throw new Error("unterminated delta")},i})},{}],14:[function(t,e,r){r.read=function(t,e,r,n,o){var i,a,s=8*o-n-1,f=(1<<s)-1,u=f>>1,c=-7,h=r?o-1:0,l=r?-1:1,p=t[e+h];for(h+=l,i=p&(1<<-c)-1,p>>=-c,c+=s;c>0;i=256*i+t[e+h],h+=l,c-=8);for(a=i&(1<<-c)-1,i>>=-c,c+=n;c>0;a=256*a+t[e+h],h+=l,c-=8);if(0===i)i=1-u;else{if(i===f)return a?NaN:(p?-1:1)*(1/0);a+=Math.pow(2,n),i-=u}return(p?-1:1)*a*Math.pow(2,i-n)},r.write=function(t,e,r,n,o,i){var a,s,f,u=8*i-o-1,c=(1<<u)-1,h=c>>1,l=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,d=n?1:-1,y=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(f=Math.pow(2,-a))<1&&(a--,f*=2),e+=a+h>=1?l/f:l*Math.pow(2,1-h),e*f>=2&&(a++,f/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(e*f-1)*Math.pow(2,o),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,o),a=0));o>=8;t[r+p]=255&s,p+=d,s/=256,o-=8);for(a=a<<o|s,u+=o;u>0;t[r+p]=255&a,p+=d,a/=256,u-=8);t[r+p-d]|=128*y}},{}],15:[function(t,e,r){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},{}],16:[function(t,e,r){(function(t){var e,n;!function(r){function o(t,e,r,n,o){if(_&&k&&(e instanceof k&&(e=new _(e)),n instanceof k&&(n=new _(n))),!(e||r||n||y))return void(t.buffer=u(A,0));if(!i(e,r)){var f=y||Array;o=r,n=e,r=0,e=new f(8)}t.buffer=e,t.offset=r|=0,"undefined"!=typeof n&&("string"==typeof n?s(e,r,n,o||10):i(n,o)?a(e,r,n,o):"number"==typeof o?(h(e,r,n),h(e,r+4,o)):n>0?l(e,r,n):0>n?p(e,r,n):a(e,r,A,0))}function i(t,e){var r=t&&t.length;return e|=0,r&&r>=e+8&&"string"!=typeof t[e]}function a(t,e,r,n){e|=0,n|=0;for(var o=0;8>o;o++)t[e++]=255&r[n++]}function s(t,e,r,n){var o=0,i=r.length,a=0,s=0;"-"===r[0]&&o++;for(var f=o;i>o;){var u=parseInt(r[o++],n);if(!(u>=0))break;s=s*n+u,a=a*n+Math.floor(s/I),s%=I}f&&(a=~a,s?s=I-s:a++),h(t,e,a),h(t,e+4,s)}function f(t,e,r,n){var o="",i=c(t,e),a=c(t,e+4),s=n&&2147483648&i;for(s&&(i=~i,a=I-a),r=r||10;;){var f=i%r*I+a;if(i=Math.floor(i/r),a=Math.floor(f/r),o=(f%r).toString(r)+o,!i&&!a)break}return s&&(o="-"+o),o}function u(t,e){return Array.prototype.slice.call(t,e,e+8)}function c(t,e){return t[e++]*O+(t[e++]<<16)+(t[e++]<<8)+t[e]}function h(t,e,r){t[e+3]=255&r,r>>=8,t[e+2]=255&r,r>>=8,t[e+1]=255&r,r>>=8,t[e]=255&r}function l(t,e,r){for(var n=e+7;n>=e;n--)t[n]=255&r,r/=256}function p(t,e,r){r++;for(var n=e+7;n>=e;n--)t[n]=255&-r^255,r/=256}function d(t){return!!t&&"[object Array]"==Object.prototype.toString.call(t)}var y,v=r.Uint64BE=e=function(t,r,n,i){return this instanceof e?o(this,t,r,n,i):new e(t,r,n,i)},g=r.Int64BE=n=function(t,e,r,i){return this instanceof n?o(this,t,e,r,i):new n(t,e,r,i)},b=v.prototype,E=g.prototype,w="undefined",m=w!==typeof t&&t,_=w!==typeof Uint8Array&&Uint8Array,k=w!==typeof ArrayBuffer&&ArrayBuffer,A=[0,0,0,0,0,0,0,0],x=Array.isArray||d,I=4294967296,O=16777216;b.buffer=E.buffer=void 0,b.offset=E.offset=0,b._isUint64BE=E._isInt64BE=!0,v.isUint64BE=function(t){return!(!t||!t._isUint64BE)},g.isInt64BE=function(t){return!(!t||!t._isInt64BE)},b.toNumber=function(){var t=this.buffer,e=this.offset,r=c(t,e),n=c(t,e+4);return r?r*I+n:n},E.toNumber=function(){var t=this.buffer,e=this.offset,r=0|c(t,e),n=c(t,e+4);return r?r*I+n:n},b.toArray=E.toArray=function(t){var e=this.buffer,r=this.offset;return y=null,t!==!1&&0===r&&8===e.length&&x(e)?e:u(e,r)},m&&(b.toBuffer=E.toBuffer=function(e){var r=this.buffer,n=this.offset;if(y=m,e!==!1&&0===n&&8===r.length&&t.isBuffer(r))return r;var o=new m(8);return a(o,0,r,n),o}),_&&(b.toArrayBuffer=E.toArrayBuffer=function(t){var e=this.buffer,r=this.offset,n=e.buffer;if(y=_,t!==!1&&0===r&&n instanceof k&&8===n.byteLength)return n;var o=new _(8);return a(o,0,e,r),o.buffer}),E.toString=function(t){return f(this.buffer,this.offset,t,!0)},b.toString=function(t){return f(this.buffer,this.offset,t,!1)},b.toJSON=b.toNumber,E.toJSON=E.toNumber}("object"==typeof r&&"string"!=typeof r.nodeName?r:this||{})}).call(this,t("buffer").Buffer)},{buffer:8}],17:[function(t,e,r){var n={}.toString;e.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},{}],18:[function(t,e,r){r.encode=t("./encode").encode,r.decode=t("./decode").decode,r.Encoder=t("./encoder").Encoder,r.Decoder=t("./decoder").Decoder,r.createCodec=t("./ext").createCodec,r.codec=t("./codec").codec},{"./codec":21,"./decode":23,"./decoder":24,"./encode":26,"./encoder":27,"./ext":30}],19:[function(t,e,r){function n(t,e){for(var r=this,n=e||0,o=t.length,i=0;o>i;i++){var a=t.charCodeAt(i);128>a?r[n++]=a:2048>a?(r[n++]=192|a>>6,r[n++]=128|63&a):(r[n++]=224|a>>12,r[n++]=128|a>>6&63,r[n++]=128|63&a)}return n-e}function o(t,e){var r=this,n=t-0||0;e||(e=r.length);var o=e-t;o>l&&(o=l);for(var i=[];e>n;){for(var a=new Array(o),s=0;o>s&&e>n;){var f=r[n++];f=128>f?f:224>f?(63&f)<<6|63&r[n++]:(63&f)<<12|(63&r[n++])<<6|63&r[n++],a[s++]=f}o>s&&(a=a.slice(0,s)),i.push(String.fromCharCode.apply("",a))}return i.length>1?i.join(""):i.length?i.shift():""}function i(t){var e=0;return Array.prototype.forEach.call(t,function(t){var r=t.charCodeAt(0);e+=128>r?1:2048>r?2:3}),e}function a(t,e,r,n){var o;r||(r=0),n||0===n||(n=this.length),e||(e=0);var i=n-r;if(t===this&&e>r&&n>e)for(o=i-1;o>=0;o--)t[o+e]=this[o+r];else for(o=0;i>o;o++)t[o+e]=this[o+r];return i}function s(t,e){new c(this,e,t)}function f(t,e){new h(this,e,t)}var u=t("int64-buffer"),c=u.Uint64BE,h=u.Int64BE,l=8192;r.writeString=n,r.readString=o,r.byteLength=i,r.copy=a,r.writeUint64BE=s,r.writeInt64BE=f},{"int64-buffer":16}],20:[function(t,e,r){function n(){}r.BufferShortageError=n,n.prototype=Error.prototype},{}],21:[function(t,e,r){r.codec={preset:t("./ext").createCodec({preset:!0})}},{"./ext":30}],22:[function(t,e,r){(function(e){function n(t){return this instanceof n?void(t&&(this.options=t,t.codec&&(this.codec=t.codec))):new n(t)}r.DecodeBuffer=n;var o=t("./codec").codec.preset,i=t("./buffer-shortage").BufferShortageError;n.prototype.offset=0,n.prototype.push=function(t){var e=this.buffers||(this.buffers=[]);e.push(t)},n.prototype.codec=o,n.prototype.write=function(t){var r=this.offset?this.buffer.slice(this.offset):this.buffer;this.buffer=r?t?e.concat([r,t]):r:t,this.offset=0},n.prototype.read=function(){var t=this.buffers&&this.buffers.length;return t?(this.flush(),this.pull()):this.fetch()},n.prototype.pull=function(){var t=this.buffers||(this.buffers=[]);return t.shift()},n.prototype.fetch=function(){return this.codec.decode(this)},n.prototype.flush=function(){for(;this.offset<this.buffer.length;){var t,e=this.offset;try{t=this.fetch()}catch(r){if(!(r instanceof i))throw r;this.offset=e;break}this.push(t)}}}).call(this,t("buffer").Buffer)},{"./buffer-shortage":20,"./codec":21,buffer:8}],23:[function(t,e,r){function n(t,e){var r=new o(e);return r.write(t),r.read()}r.decode=n;var o=t("./decode-buffer").DecodeBuffer},{"./decode-buffer":22}],24:[function(t,e,r){function n(t){return this instanceof n?void i.call(this,t):new n(t)}r.Decoder=n;var o=t("event-lite"),i=t("./decode-buffer").DecodeBuffer;n.prototype=new i,o.mixin(n.prototype),n.prototype.decode=function(t){arguments.length&&this.write(t),this.flush()},n.prototype.push=function(t){this.emit("data",t)},n.prototype.end=function(t){this.decode(t),this.emit("end")}},{"./decode-buffer":22,"event-lite":10}],25:[function(t,e,r){(function(e){function n(t){return this instanceof n?void(t&&(this.options=t,t.codec&&(this.codec=t.codec))):new n(t)}r.EncodeBuffer=n;var o=t("./codec").codec.preset,i=2048,a=65536;n.prototype.offset=0,n.prototype.start=0,n.prototype.push=function(t){var e=this.buffers||(this.buffers=[]);e.push(t)},n.prototype.codec=o,n.prototype.write=function(t){this.codec.encode(this,t)},n.prototype.read=function(){var t=this.buffers&&this.buffers.length;return t?(this.flush(),this.pull()):this.fetch()},n.prototype.pull=function(){var t=this.buffers||(this.buffers=[]),r=t.length>1?e.concat(t):t[0];return t.length=0,r},n.prototype.fetch=function(){var t=this.start;return t<this.offset?(this.start=this.offset,this.buffer.slice(t,this.offset)):void 0},n.prototype.flush=function(){var t=this.fetch();t&&this.push(t)},n.prototype.reserve=function(t){if(this.buffer){var r=this.buffer.length;if(this.offset+t<r)return;this.flush(),t=Math.max(t,Math.min(2*r,a))}t=t>i?t:i,this.buffer=new e(t),this.start=0,this.offset=0},n.prototype.send=function(t){var e=this.offset+t.length;this.buffer&&e<this.buffer.length?(t.copy(this.buffer,this.offset),this.offset=e):(this.flush(),this.push(t))}}).call(this,t("buffer").Buffer)},{"./codec":21,buffer:8}],26:[function(t,e,r){function n(t,e){var r=new o(e);return r.write(t),r.read()}r.encode=n;var o=t("./encode-buffer").EncodeBuffer},{"./encode-buffer":25}],27:[function(t,e,r){function n(t){return this instanceof n?void i.call(this,t):new n(t)}r.Encoder=n;var o=t("event-lite"),i=t("./encode-buffer").EncodeBuffer;n.prototype=new i,o.mixin(n.prototype),n.prototype.encode=function(t){this.write(t),this.emit("data",this.read())},n.prototype.end=function(t){arguments.length&&this.encode(t),this.flush(),this.emit("end")}},{"./encode-buffer":25,"event-lite":10}],28:[function(t,e,r){function n(t,e){return this instanceof n?(this.buffer=t,void(this.type=e)):new n(t,e)}r.ExtBuffer=n},{}],29:[function(t,e,r){(function(e){function n(t){o(t),i(t)}function o(t){t.addExtPacker(14,Error,[l,a]),t.addExtPacker(1,EvalError,[l,a]),t.addExtPacker(2,RangeError,[l,a]),t.addExtPacker(3,ReferenceError,[l,a]),t.addExtPacker(4,SyntaxError,[l,a]),t.addExtPacker(5,TypeError,[l,a]),t.addExtPacker(6,URIError,[l,a]),t.addExtPacker(10,RegExp,[c,a]),t.addExtPacker(11,Boolean,[u,a]),t.addExtPacker(12,String,[u,a]),t.addExtPacker(13,Date,[Number,a]),t.addExtPacker(15,Number,[u,a]),w&&(t.addExtPacker(17,Int8Array,f),t.addExtPacker(18,Uint8Array,f),t.addExtPacker(19,Int16Array,y),t.addExtPacker(20,Uint16Array,y),t.addExtPacker(21,Int32Array,y),t.addExtPacker(22,Uint32Array,y),t.addExtPacker(23,Float32Array,y),m&&t.addExtPacker(24,Float64Array,y),_&&(t.addExtPacker(25,Uint8ClampedArray,f),t.addExtUnpacker(25,d(Uint8ClampedArray))),t.addExtPacker(26,ArrayBuffer,v),t.addExtPacker(29,DataView,y),t.addExtUnpacker(26,g),t.addExtUnpacker(29,[g,d(DataView)]))}function i(t){t.addExtPacker(14,Error,[l,a]),t.addExtPacker(1,EvalError,[l,a]),t.addExtPacker(2,RangeError,[l,a]),t.addExtPacker(3,ReferenceError,[l,a]),t.addExtPacker(4,SyntaxError,[l,a]),t.addExtPacker(5,TypeError,[l,a]),t.addExtPacker(6,URIError,[l,a]),t.addExtUnpacker(14,[s,p(Error)]),t.addExtUnpacker(1,[s,p(EvalError)]),t.addExtUnpacker(2,[s,p(RangeError)]),t.addExtUnpacker(3,[s,p(ReferenceError)]),t.addExtUnpacker(4,[s,p(SyntaxError)]),t.addExtUnpacker(5,[s,p(TypeError)]),t.addExtUnpacker(6,[s,p(URIError)]),t.addExtPacker(10,RegExp,[c,a]),t.addExtPacker(11,Boolean,[u,a]),t.addExtPacker(12,String,[u,a]),t.addExtPacker(13,Date,[Number,a]),t.addExtPacker(15,Number,[u,a]),t.addExtUnpacker(10,[s,h]),t.addExtUnpacker(11,[s,d(Boolean)]),t.addExtUnpacker(12,[s,d(String)]),t.addExtUnpacker(13,[s,d(Date)]),t.addExtUnpacker(15,[s,d(Number)]),w&&(t.addExtPacker(17,Int8Array,f),t.addExtPacker(18,Uint8Array,f),t.addExtPacker(19,Int16Array,y),t.addExtPacker(20,Uint16Array,y),t.addExtPacker(21,Int32Array,y),t.addExtPacker(22,Uint32Array,y),t.addExtPacker(23,Float32Array,y),t.addExtUnpacker(17,d(Int8Array)),t.addExtUnpacker(18,d(Uint8Array)),t.addExtUnpacker(19,[g,d(Int16Array)]),t.addExtUnpacker(20,[g,d(Uint16Array)]),t.addExtUnpacker(21,[g,d(Int32Array)]),t.addExtUnpacker(22,[g,d(Uint32Array)]),t.addExtUnpacker(23,[g,d(Float32Array)]),m&&(t.addExtPacker(24,Float64Array,y),t.addExtUnpacker(24,[g,d(Float64Array)])),_&&(t.addExtPacker(25,Uint8ClampedArray,f),t.addExtUnpacker(25,d(Uint8ClampedArray))),t.addExtPacker(26,ArrayBuffer,v),t.addExtPacker(29,DataView,y),t.addExtUnpacker(26,g),t.addExtUnpacker(29,[g,d(DataView)]))}function a(e){return b||(b=t("./encode").encode),b(e)}function s(e){return E||(E=t("./decode").decode),E(e)}function f(t){return new e(t)}function u(t){return t.valueOf()}function c(t){t=RegExp.prototype.toString.call(t).split("/"),t.shift();var e=[t.pop()];return e.unshift(t.join("/")),e}function h(t){return RegExp.apply(null,t)}function l(t){var e={};for(var r in k)e[r]=t[r];return e}function p(t){return function(e){var r=new t;for(var n in k)r[n]=e[n];return r}}function d(t){return function(e){return new t(e)}}function y(t){return new e(new Uint8Array(t.buffer))}function v(t){return new e(new Uint8Array(t))}function g(t){return new Uint8Array(t).buffer}r.setExtPreset=n;var b,E,w="undefined"!=typeof Uint8Array,m="undefined"!=typeof Float64Array,_="undefined"!=typeof Uint8ClampedArray,k={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1}}).call(this,t("buffer").Buffer)},{"./decode":23,"./encode":26,buffer:8}],30:[function(t,e,r){function n(t){return this instanceof n?(this.extPackers={},this.extUnpackers=[],this.encode=c.getEncoder(t),this.decode=u.getDecoder(t),void(t&&t.preset&&f.setExtPreset(this))):new n(t)}function o(t){return new n(t)}function i(t){function e(t,e){return e(t)}return t=t.slice(),function(r){return t.reduce(e,r)}}var a=t("isarray");r.createCodec=o;var s=t("./ext-buffer").ExtBuffer,f=t("./ext-preset"),u=t("./read-core"),c=t("./write-core");n.prototype.addExtPacker=function(t,e,r){function n(e){var n=r(e);return new s(n,t)}a(r)&&(r=i(r));var o=e.name;if(o&&"Object"!==o)this.extPackers[o]=n;else{var f=this.extEncoderList||(this.extEncoderList=[]);f.unshift([e,n])}},n.prototype.addExtUnpacker=function(t,e){this.extUnpackers[t]=a(e)?i(e):e},n.prototype.getExtPacker=function(t){var e=t.constructor,r=e&&e.name&&this.extPackers[e.name];if(r)return r;var n=this.extEncoderList;if(n)for(var o=n.length,i=0;o>i;i++){var a=n[i];if(e===a[0])return a[1]}},n.prototype.getExtUnpacker=function(t){function e(e){return new s(e,t)}return this.extUnpackers[t]||e}},{"./ext-buffer":28,"./ext-preset":29,"./read-core":31,"./write-core":34,isarray:17}],31:[function(t,e,r){function n(t){function e(t){var e=o(t),n=r[e];if(!n)throw new Error("Invalid type: "+(e?"0x"+e.toString(16):e));return n(t)}var r=i.getReadToken(t);return e}r.getDecoder=n;var o=t("./read-format").readUint8,i=t("./read-token")},{"./read-format":32,"./read-token":33}],32:[function(t,e,r){(function(e){function n(t){var r={map:o,array:i,str:a,bin:s,ext:f,uint8:u,uint16:c,uint32:h(4,e.prototype.readUInt32BE),uint64:h(8,l),int8:h(1,e.prototype.readInt8),int16:h(2,e.prototype.readInt16BE),int32:h(4,e.prototype.readInt32BE),int64:h(8,p),float32:h(4,v),float64:h(8,g)};return t&&t.int64&&(r.uint64=h(8,d),r.int64=h(8,y)),r}function o(t,e){var r,n={},o=new Array(e),i=new Array(e),a=t.codec.decode;for(r=0;e>r;r++)o[r]=a(t),i[r]=a(t);for(r=0;e>r;r++)n[o[r]]=i[r];return n}function i(t,e){for(var r=new Array(e),n=t.codec.decode,o=0;e>o;o++)r[o]=n(t);return r}function a(t,r){var n=t.offset,o=t.offset=n+r,i=t.buffer;if(o>i.length)throw new A;return x||!e.isBuffer(i)?k.readString.call(i,n,o):i.toString("utf-8",n,o)}function s(t,e){var r=t.offset,n=t.offset=r+e;if(n>t.buffer.length)throw new A;return b.call(t.buffer,r,n)}function f(t,e){var r=t.offset,n=t.offset=r+e+1;if(n>t.buffer.length)throw new A;var o=t.buffer[r],i=t.codec.getExtUnpacker(o);if(!i)throw new Error("Invalid ext type: "+(o?"0x"+o.toString(16):o));var a=b.call(t.buffer,r+1,n);return i(a)}function u(t){var e=t.buffer;if(t.offset>=e.length)throw new A;return e[t.offset++]}function c(t){var e=t.buffer;if(t.offset+2>e.length)throw new A;return e[t.offset++]<<8|e[t.offset++]}function h(t,e){return function(r){var n=r.offset,o=r.offset=n+t;if(o>r.buffer.length)throw new A;return e.call(r.buffer,n,I)}}function l(t){return new m(this,t).toNumber()}function p(t){return new _(this,t).toNumber()}function d(t){return new m(this,t)}function y(t){return new _(this,t)}function v(t){return this.readFloatBE?this.readFloatBE(t):E.read(this,t,!1,23,4)}function g(t){return this.readDoubleBE?this.readDoubleBE(t):E.read(this,t,!1,52,8)}function b(t,r){var n=this.slice||Array.prototype.slice,o=n.call(this,t,r);return e.isBuffer(o)||(o=e(o)),o}var E=t("ieee754"),w=t("int64-buffer"),m=w.Uint64BE,_=w.Int64BE;r.getReadFormat=n,r.readUint8=u;var k=t("./buffer-lite"),A=t("./buffer-shortage").BufferShortageError,x="TYPED_ARRAY_SUPPORT"in e,I=!0}).call(this,t("buffer").Buffer)},{"./buffer-lite":19,"./buffer-shortage":20,buffer:8,ieee754:14,"int64-buffer":16}],33:[function(t,e,r){function n(t){var e=u.getReadFormat(t);return t&&t.useraw?i(e):o(e)}function o(t){var e,r=new Array(256);for(e=0;127>=e;e++)r[e]=a(e);for(e=128;143>=e;e++)r[e]=f(e-128,t.map);for(e=144;159>=e;e++)r[e]=f(e-144,t.array);for(e=160;191>=e;e++)r[e]=f(e-160,t.str);for(r[192]=a(null),r[193]=null,r[194]=a(!1),r[195]=a(!0),r[196]=s(t.uint8,t.bin),r[197]=s(t.uint16,t.bin),r[198]=s(t.uint32,t.bin),r[199]=s(t.uint8,t.ext),r[200]=s(t.uint16,t.ext),r[201]=s(t.uint32,t.ext),r[202]=t.float32,r[203]=t.float64,r[204]=t.uint8,r[205]=t.uint16,r[206]=t.uint32,r[207]=t.uint64,r[208]=t.int8,r[209]=t.int16,r[210]=t.int32,r[211]=t.int64,r[212]=f(1,t.ext),r[213]=f(2,t.ext),r[214]=f(4,t.ext),r[215]=f(8,t.ext),r[216]=f(16,t.ext),r[217]=s(t.uint8,t.str),r[218]=s(t.uint16,t.str),r[219]=s(t.uint32,t.str),r[220]=s(t.uint16,t.array),r[221]=s(t.uint32,t.array),r[222]=s(t.uint16,t.map),r[223]=s(t.uint32,t.map),e=224;255>=e;e++)r[e]=a(e-256);return r}function i(t){var e,r=n(t).slice();for(r[217]=r[196],
r[218]=r[197],r[219]=r[198],e=160;191>=e;e++)r[e]=f(e-160,t.bin);return r}function a(t){return function(){return t}}function s(t,e){return function(r){var n=t(r);return e(r,n)}}function f(t,e){return function(r){return e(r,t)}}var u=t("./read-format");r.getReadToken=n},{"./read-format":32}],34:[function(t,e,r){function n(t){function e(t,e){var n=r[typeof e];if(!n)throw new Error('Unsupported type "'+typeof e+'": '+e);n(t,e)}var r=o.getWriteType(t);return e}r.getEncoder=n;var o=t("./write-type")},{"./write-type":36}],35:[function(t,e,r){(function(e){function n(t){return p||t&&t.safe?i():o()}function o(){var t=h.slice();return t[196]=a(196),t[197]=s(197),t[198]=f(198),t[199]=a(199),t[200]=s(200),t[201]=f(201),t[202]=u(202,4,e.prototype.writeFloatBE,!0),t[203]=u(203,8,e.prototype.writeDoubleBE,!0),t[204]=a(204),t[205]=s(205),t[206]=f(206),t[207]=u(207,8,c.writeUint64BE),t[208]=a(208),t[209]=s(209),t[210]=f(210),t[211]=u(211,8,c.writeUint64BE),t[217]=a(217),t[218]=s(218),t[219]=f(219),t[220]=s(220),t[221]=f(221),t[222]=s(222),t[223]=f(223),t}function i(){var t=h.slice();return t[196]=u(196,1,e.prototype.writeUInt8),t[197]=u(197,2,e.prototype.writeUInt16BE),t[198]=u(198,4,e.prototype.writeUInt32BE),t[199]=u(199,1,e.prototype.writeUInt8),t[200]=u(200,2,e.prototype.writeUInt16BE),t[201]=u(201,4,e.prototype.writeUInt32BE),t[202]=u(202,4,e.prototype.writeFloatBE),t[203]=u(203,8,e.prototype.writeDoubleBE),t[204]=u(204,1,e.prototype.writeUInt8),t[205]=u(205,2,e.prototype.writeUInt16BE),t[206]=u(206,4,e.prototype.writeUInt32BE),t[207]=u(207,8,c.writeUint64BE),t[208]=u(208,1,e.prototype.writeInt8),t[209]=u(209,2,e.prototype.writeInt16BE),t[210]=u(210,4,e.prototype.writeInt32BE),t[211]=u(211,8,c.writeUint64BE),t[217]=u(217,1,e.prototype.writeUInt8),t[218]=u(218,2,e.prototype.writeUInt16BE),t[219]=u(219,4,e.prototype.writeUInt32BE),t[220]=u(220,2,e.prototype.writeUInt16BE),t[221]=u(221,4,e.prototype.writeUInt32BE),t[222]=u(222,2,e.prototype.writeUInt16BE),t[223]=u(223,4,e.prototype.writeUInt32BE),t}function a(t){return function(e,r){e.reserve(2);var n=e.buffer,o=e.offset;n[o++]=t,n[o++]=r,e.offset=o}}function s(t){return function(e,r){e.reserve(3);var n=e.buffer,o=e.offset;n[o++]=t,n[o++]=r>>>8,n[o++]=r,e.offset=o}}function f(t){return function(e,r){e.reserve(5);var n=e.buffer,o=e.offset;n[o++]=t,n[o++]=r>>>24,n[o++]=r>>>16,n[o++]=r>>>8,n[o++]=r,e.offset=o}}function u(t,e,r,n){return function(o,i){o.reserve(e+1),o.buffer[o.offset++]=t,r.call(o.buffer,i,o.offset,n),o.offset+=e}}var c=t("./buffer-lite"),h=t("./write-uint8").uint8,l="TYPED_ARRAY_SUPPORT"in e,p=l&&!e.TYPED_ARRAY_SUPPORT;r.getWriteToken=n}).call(this,t("buffer").Buffer)},{"./buffer-lite":19,"./write-uint8":37,buffer:8}],36:[function(t,e,r){(function(e){function n(t){function r(t,e){var r=e?195:194;A[r](t,e)}function n(t,e){var r,n=0|e;return e!==n?(r=203,void A[r](t,e)):(r=n>=-32&&127>=n?255&n:n>=0?255>=n?204:65535>=n?205:206:n>=-128?208:n>=-32768?209:210,void A[r](t,n))}function a(t,e){var r=207;A[r](t,e.toArray())}function p(t,e){var r=211;A[r](t,e.toArray())}function y(t,e){var r=e.length,n=5+3*r;t.reserve(n);var i=32>r?1:255>=r?2:65535>=r?3:5,a=t.offset+i;r=u.writeString.call(t.buffer,e,a);var s=32>r?1:255>=r?2:65535>=r?3:5;i!==s&&o(t,a,r,s-i);var f=1===s?160+r:3>=s?215+s:219;A[f](t,r),t.offset+=r}function v(t,r){if(null===r)return g(t,r);if(e.isBuffer(r))return E(t,r);if(i(r))return b(t,r);if(s.isUint64BE(r))return a(t,r);if(f.isInt64BE(r))return p(t,r);var n=t.codec.getExtPacker(r);return n&&(r=n(r)),r instanceof l?w(t,r):void m(t,r)}function g(t,e){var r=192;A[r](t,e)}function b(t,e){var r=e.length,n=16>r?144+r:65535>=r?220:221;A[n](t,r);for(var o=t.codec.encode,i=0;r>i;i++)o(t,e[i])}function E(t,e){var r=e.length,n=255>r?196:65535>=r?197:198;A[n](t,r),t.send(e)}function w(t,e){var r=e.buffer,n=r.length,o=d[n]||(255>n?199:65535>=n?200:201);A[o](t,n),h[e.type](t),t.send(r)}function m(t,e){var r=Object.keys(e),n=r.length,o=16>n?128+n:65535>=n?222:223;A[o](t,n);var i=t.codec.encode;r.forEach(function(r){i(t,r),i(t,e[r])})}function _(t,e){var r=e.length,n=5+3*r;t.reserve(n);var i=32>r?1:65535>=r?3:5,a=t.offset+i;r=u.writeString.call(t.buffer,e,a);var s=32>r?1:65535>=r?3:5;i!==s&&o(t,a,r,s-i);var f=32>r?160+r:65535>=r?218:219;A[f](t,r),t.offset+=r}function k(t,r){if(!e.isBuffer(r))return v(t,r);var n=r.length,o=32>n?160+n:65535>=n?218:219;A[o](t,n),t.send(r)}var A=c.getWriteToken(t),x={"boolean":r,"function":g,number:n,object:v,string:y,symbol:g,undefined:g};return t&&t.useraw&&(x.object=k,x.string=_),x}function o(t,e,r,n){var o=e+n,i=e+r;p?u.copy.call(t.buffer,t.buffer,o,e,i):t.buffer.copy(t.buffer,o,e,i)}var i=t("isarray"),a=t("int64-buffer"),s=a.Uint64BE,f=a.Int64BE,u=t("./buffer-lite"),c=t("./write-token"),h=t("./write-uint8").uint8,l=t("./ext-buffer").ExtBuffer,p="TYPED_ARRAY_SUPPORT"in e,d=[];d[1]=212,d[2]=213,d[4]=214,d[8]=215,d[16]=216,r.getWriteType=n}).call(this,t("buffer").Buffer)},{"./buffer-lite":19,"./ext-buffer":28,"./write-token":35,"./write-uint8":37,buffer:8,"int64-buffer":16,isarray:17}],37:[function(t,e,r){function n(t){return function(e){e.reserve(1),e.buffer[e.offset++]=t}}for(var o=r.uint8=new Array(256),i=0;255>=i;i++)o[i]=n(i)},{}],38:[function(t,e,r){e.exports=t("./lib/checks")},{"./lib/checks":39}],39:[function(t,e,r){function n(t,e,r,n){r=r||"";var o=f.format.apply(this,[r].concat(n)),i=new t(o);throw Error.captureStackTrace(i,e),i}function o(t,e,r){n(u.IllegalArgumentError,t,e,r)}function i(t,e,r){n(u.IllegalStateError,t,e,r)}function a(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array"}return e}function s(t){return function(e,r){var n=a(e);return n==t?e:void o(arguments.callee,r||'Expected "'+t+'" but got "'+n+'".',Array.prototype.slice.call(arguments,2))}}var f=t("util"),u=e.exports=t("./errors");e.exports.checkArgument=function(t,e){t||o(arguments.callee,e,Array.prototype.slice.call(arguments,2))},e.exports.checkState=function(t,e){t||i(arguments.callee,e,Array.prototype.slice.call(arguments,2))},e.exports.checkIsDef=function(t,e){return void 0!==t?t:void o(arguments.callee,e||"Expected value to be defined but was undefined.",Array.prototype.slice.call(arguments,2))},e.exports.checkIsDefAndNotNull=function(t,e){return null!=t?t:void o(arguments.callee,e||'Expected value to be defined and not null but got "'+a(t)+'".',Array.prototype.slice.call(arguments,2))},e.exports.checkIsString=s("string"),e.exports.checkIsArray=s("array"),e.exports.checkIsNumber=s("number"),e.exports.checkIsBoolean=s("boolean"),e.exports.checkIsFunction=s("function"),e.exports.checkIsObject=s("object")},{"./errors":40,util:43}],40:[function(t,e,r){function n(t){Error.call(this,t),this.message=t}function o(t){Error.call(this,t),this.message=t}var i=t("util");i.inherits(n,Error),n.prototype.name="IllegalArgumentError",i.inherits(o,Error),o.prototype.name="IllegalStateError",e.exports.IllegalStateError=o,e.exports.IllegalArgumentError=n},{util:43}],41:[function(t,e,r){function n(){c=!1,s.length?u=s.concat(u):h=-1,u.length&&o()}function o(){if(!c){var t=setTimeout(n);c=!0;for(var e=u.length;e;){for(s=u,u=[];++h<e;)s&&s[h].run();h=-1,e=u.length}s=null,c=!1,clearTimeout(t)}}function i(t,e){this.fun=t,this.array=e}function a(){}var s,f=e.exports={},u=[],c=!1,h=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new i(t,e)),1!==u.length||c||setTimeout(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=a,f.addListener=a,f.once=a,f.off=a,f.removeListener=a,f.removeAllListeners=a,f.emit=a,f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],42:[function(t,e,r){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],43:[function(t,e,r){(function(e,n){function o(t,e){var n={seen:[],stylize:a};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),y(e)?n.showHidden=e:e&&r._extend(n,e),m(n.showHidden)&&(n.showHidden=!1),m(n.depth)&&(n.depth=2),m(n.colors)&&(n.colors=!1),m(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=i),f(n,t,n.depth)}function i(t,e){var r=o.styles[e];return r?"["+o.colors[r][0]+"m"+t+"["+o.colors[r][1]+"m":t}function a(t,e){return t}function s(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}function f(t,e,n){if(t.customInspect&&e&&I(e.inspect)&&e.inspect!==r.inspect&&(!e.constructor||e.constructor.prototype!==e)){var o=e.inspect(n,t);return E(o)||(o=f(t,o,n)),o}var i=u(t,e);if(i)return i;var a=Object.keys(e),y=s(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(e)),x(e)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return c(e);if(0===a.length){if(I(e)){var v=e.name?": "+e.name:"";return t.stylize("[Function"+v+"]","special")}if(_(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(A(e))return t.stylize(Date.prototype.toString.call(e),"date");if(x(e))return c(e)}var g="",b=!1,w=["{","}"];if(d(e)&&(b=!0,w=["[","]"]),I(e)){var m=e.name?": "+e.name:"";g=" [Function"+m+"]"}if(_(e)&&(g=" "+RegExp.prototype.toString.call(e)),A(e)&&(g=" "+Date.prototype.toUTCString.call(e)),x(e)&&(g=" "+c(e)),0===a.length&&(!b||0==e.length))return w[0]+g+w[1];if(0>n)return _(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var k;return k=b?h(t,e,n,y,a):a.map(function(r){return l(t,e,n,y,r,b)}),t.seen.pop(),p(k,g,w)}function u(t,e){if(m(e))return t.stylize("undefined","undefined");if(E(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return b(e)?t.stylize(""+e,"number"):y(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,r,n,o){for(var i=[],a=0,s=e.length;s>a;++a)U(e,String(a))?i.push(l(t,e,r,n,String(a),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(l(t,e,r,n,o,!0))}),i}function l(t,e,r,n,o,i){var a,s,u;if(u=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]},u.get?s=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(s=t.stylize("[Setter]","special")),U(n,o)||(a="["+o+"]"),s||(t.seen.indexOf(u.value)<0?(s=v(r)?f(t,u.value,null):f(t,u.value,r-1),s.indexOf("\n")>-1&&(s=i?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n"))):s=t.stylize("[Circular]","special")),m(a)){if(i&&o.match(/^\d+$/))return s;a=JSON.stringify(""+o),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function p(t,e,r){var n=0,o=t.reduce(function(t,e){return n++,e.indexOf("\n")>=0&&n++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return o>60?r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}function d(t){return Array.isArray(t)}function y(t){return"boolean"==typeof t}function v(t){return null===t}function g(t){return null==t}function b(t){return"number"==typeof t}function E(t){return"string"==typeof t}function w(t){return"symbol"==typeof t}function m(t){return void 0===t}function _(t){return k(t)&&"[object RegExp]"===B(t)}function k(t){return"object"==typeof t&&null!==t}function A(t){return k(t)&&"[object Date]"===B(t)}function x(t){return k(t)&&("[object Error]"===B(t)||t instanceof Error)}function I(t){return"function"==typeof t}function O(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function B(t){return Object.prototype.toString.call(t)}function P(t){return 10>t?"0"+t.toString(10):t.toString(10)}function R(){var t=new Date,e=[P(t.getHours()),P(t.getMinutes()),P(t.getSeconds())].join(":");return[t.getDate(),C[t.getMonth()],e].join(" ")}function U(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var T=/%[sdj%]/g;r.format=function(t){if(!E(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(o(arguments[r]));return e.join(" ")}for(var r=1,n=arguments,i=n.length,a=String(t).replace(T,function(t){if("%%"===t)return"%";if(r>=i)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return t}}),s=n[r];i>r;s=n[++r])a+=v(s)||!k(s)?" "+s:" "+o(s);return a},r.deprecate=function(t,o){function i(){if(!a){if(e.throwDeprecation)throw new Error(o);e.traceDeprecation?console.trace(o):console.error(o),a=!0}return t.apply(this,arguments)}if(m(n.process))return function(){return r.deprecate(t,o).apply(this,arguments)};if(e.noDeprecation===!0)return t;var a=!1;return i};var S,D={};r.debuglog=function(t){if(m(S)&&(S=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!D[t])if(new RegExp("\\b"+t+"\\b","i").test(S)){var n=e.pid;D[t]=function(){var e=r.format.apply(r,arguments);console.error("%s %d: %s",t,n,e)}}else D[t]=function(){};return D[t]},r.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=d,r.isBoolean=y,r.isNull=v,r.isNullOrUndefined=g,r.isNumber=b,r.isString=E,r.isSymbol=w,r.isUndefined=m,r.isRegExp=_,r.isObject=k,r.isDate=A,r.isError=x,r.isFunction=I,r.isPrimitive=O,r.isBuffer=t("./support/isBuffer");var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];r.log=function(){console.log("%s - %s",R(),r.format.apply(r,arguments))},r.inherits=t("inherits"),r._extend=function(t,e){if(!e||!k(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":42,_process:41,inherits:15}],44:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=t("backoff"),a=function(){function t(e){var r=arguments.length<=1||void 0===arguments[1]?null:arguments[1],o=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];n(this,t),this.url=e,this._protocols=r,this.reconnectEnabled=!0,this.listeners={},this.backoff=i[o.backoff||"fibonacci"](o),this.backoff.on("backoff",this.onBackoffStart.bind(this)),this.backoff.on("ready",this.onBackoffReady.bind(this)),this.backoff.on("fail",this.onBackoffFail.bind(this)),this.open()}return o(t,[{key:"open",value:function(){var t=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];this.isReconnect=t,this.ws=new WebSocket(this.url,this._protocols),this.ws.onclose=this.onCloseCallback.bind(this),this.ws.onerror=this.onErrorCallback.bind(this),this.ws.onmessage=this.onMessageCallback.bind(this),this.ws.onopen=this.onOpenCallback.bind(this)}},{key:"onBackoffStart",value:function(t,e){}},{key:"onBackoffReady",value:function(t,e){this.open(!0)}},{key:"onBackoffFail",value:function(){}},{key:"onCloseCallback",value:function(){!this.isReconnect&&this.listeners.onclose&&this.listeners.onclose.apply(null,arguments),this.reconnectEnabled&&this.backoff.backoff()}},{key:"onErrorCallback",value:function(){this.listeners.onerror&&this.listeners.onerror.apply(null,arguments)}},{key:"onMessageCallback",value:function(){this.listeners.onmessage&&this.listeners.onmessage.apply(null,arguments)}},{key:"onOpenCallback",value:function(){this.listeners.onopen&&this.listeners.onopen.apply(null,arguments),this.isReconnect&&this.listeners.onreconnect&&this.listeners.onreconnect.apply(null,arguments),this.isReconnect=!1}},{key:"close",value:function(t,e){"undefined"==typeof t&&(t=1e3),this.reconnectEnabled=!1,this.ws.close(t,e)}},{key:"send",value:function(t){this.ws.send(t)}},{key:"bufferedAmount",get:function(){return this.ws.bufferedAmount}},{key:"readyState",get:function(){return this.ws.readyState}},{key:"binaryType",get:function(){return this.ws.binaryType},set:function(t){this.ws.binaryType=t}},{key:"extensions",get:function(){return this.ws.extensions},set:function(t){this.ws.extensions=t}},{key:"protocol",get:function(){return this.ws.protocol},set:function(t){this.ws.protocol=t}},{key:"onclose",set:function(t){this.listeners.onclose=t},get:function(){return this.listeners.onclose}},{key:"onerror",set:function(t){this.listeners.onerror=t},get:function(){return this.listeners.onerror}},{key:"onmessage",set:function(t){this.listeners.onmessage=t},get:function(){return this.listeners.onmessage}},{key:"onopen",set:function(t){this.listeners.onopen=t},get:function(){return this.listeners.onopen}},{key:"onreconnect",set:function(t){this.listeners.onreconnect=t},get:function(){return this.listeners.onreconnect}}]),t}();a.CONNECTING=WebSocket.CONNECTING,a.OPEN=WebSocket.OPEN,a.CLOSING=WebSocket.CLOSING,a.CLOSED=WebSocket.CLOSED,r["default"]=a},{backoff:1}],45:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(f){o=!0,i=f}finally{try{!n&&s["return"]&&s["return"]()}finally{if(o)throw i}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function b(t,e,r){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var o=Object.getPrototypeOf(t);return null===o?void 0:b(o,e,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)},c=t("websocket.js"),h=n(c),l=t("msgpack-lite"),p=n(l),d=t("./protocol"),y=n(d),v=t("./room"),g=function(t){function e(t){var r=arguments.length<=1||void 0===arguments[1]?null:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];o(this,e);var a=i(this,Object.getPrototypeOf(e).call(this,t,r,n));return a.binaryType="arraybuffer",a.rooms={},a._enqueuedCalls=[],a}return a(e,t),f(e,[{key:"onOpenCallback",value:function(t){if(this._enqueuedCalls.length>0)for(var e=0;e<this._enqueuedCalls.length;e++){var r=s(this._enqueuedCalls[e],2),n=r[0],o=r[1];this[n].apply(this,o)}}},{key:"send",value:function(t){return this.ws.readyState==WebSocket.OPEN?u(Object.getPrototypeOf(e.prototype),"send",this).call(this,p["default"].encode(t)):void this._enqueuedCalls.push(["send",[t]])}},{key:"join",value:function(t,e){return this.rooms[t]||(this.rooms[t]=(0,v.createRoom)(this,t)),this.send([y["default"].JOIN_ROOM,t,e||{}]),this.rooms[t]}},{key:"onMessageCallback",value:function(t){var e=p["default"].decode(new Uint8Array(t.data));if("number"==typeof e[0]){var r=e[1];if(e[0]==y["default"].USER_ID)return this.id=r,this.listeners.onopen&&this.listeners.onopen.apply(null),!0;if(e[0]==y["default"].JOIN_ROOM)return this.rooms[e[2]]&&(this.rooms[r]=this.rooms[e[2]],delete this.rooms[e[2]]),this.rooms[r].id=r,this.rooms[r].emit("join"),!0;if(e[0]==y["default"].JOIN_ERROR){var n=this.rooms[r];return delete this.rooms[r],n.emit("error",e[2]),!0}if(e[0]==y["default"].LEAVE_ROOM)return this.rooms[r].emit("leave"),!0;if(e[0]==y["default"].ROOM_STATE){var o=e[2],i=e[3],a=e[4];return this.rooms[r].setState(o,i,a),!0}if(e[0]==y["default"].ROOM_STATE_PATCH){var s=e[2];return this.rooms[r].ping||this.rooms[r].ping,this.rooms[r].patch(s),!0}e[0]==y["default"].ROOM_DATA&&(this.rooms[r].emit("data",e[2]),e=[e[2]])}this.listeners.onmessage&&this.listeners.onmessage.apply(null,e)}}]),e}(h["default"]);e.exports=g},{"./protocol":46,"./room":47,"msgpack-lite":18,"websocket.js":44}],46:[function(t,e,r){"use strict";e.exports.USER_ID=1,e.exports.JOIN_ROOM=10,e.exports.JOIN_ERROR=11,e.exports.LEAVE_ROOM=12,e.exports.ROOM_DATA=13,e.exports.ROOM_STATE=14,e.exports.ROOM_STATE_PATCH=15,e.exports.BAD_REQUEST=50},{}],47:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){return new d(t,e)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();r.createRoom=a;var f=t("events").EventEmitter,u=t("fast-json-patch"),c=t("msgpack-lite"),h=t("fossil-delta"),l=t("clock.js"),p=t("./protocol"),d=function(t){function e(t,r){n(this,e);var i=o(this,Object.getPrototypeOf(e).call(this));return i.id=null,i.client=t,i.name=r,i.state={},i.clock=new l,i.remoteClock=new l,i.lastPatchTime=null,i.ping=null,i.on("leave",function(){return i.removeAllListeners()}),i}return i(e,t),s(e,[{key:"setState",value:function(t,e,r){this.state=t,this._previousState=c.encode(this.state),this.remoteClock.currentTime=e,this.remoteClock.elapsedTime=r,this.clock.start(),this.emit("update",t)}},{key:"patch",value:function(t){var e=Date.now();this.lastPatchTime&&(this.ping=e-this.lastPatchTime),this.lastPatchTime=e,this.clock.tick(),this._previousState=h.apply(this._previousState,t);var r=c.decode(this._previousState),n=u.compare(this.state,r);this.emit("patch",n),u.apply(this.state,n),this.emit("update",this.state,n)}},{key:"leave",value:function(){this.id>=0&&this.client.send([p.LEAVE_ROOM,this.id])}},{key:"send",value:function(t){this.client.send([p.ROOM_DATA,this.id,t])}}]),e}(f)},{"./protocol":46,"clock.js":9,events:11,"fast-json-patch":12,"fossil-delta":13,"msgpack-lite":18}]},{},[45])(45)});
